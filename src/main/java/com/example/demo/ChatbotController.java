package com.example.demo;

import lombok.extern.slf4j.Slf4j;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RestController;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

@Slf4j
@RestController
public class ChatbotController {
    @PostMapping("/webhook")
    public WebhookResponse webhook(@RequestBody WebhookRequest data){
        Map <String, List<String>> pizzas = new HashMap<>();
        pizzas.put("Creme", List.of("Lorraine", "Saumon"));
        pizzas.put("Tomate", List.of("Savoyarde", "Tartiflette"));
        Map <String, List<String>> cremes = new HashMap<>();
        cremes.put("Lorraine", List.of("15€", "https://recette.supertoinette.com/151100/b/pizza-lorraine.jpg"));
        cremes.put("Saumon", List.of("14€", "https://www.cuisineactuelle.fr/imgre/fit/http.3A.2F.2Fprd2-bone-image.2Es3-website-eu-west-1.2Eamazonaws.2Ecom.2Fcac.2F2018.2F09.2F25.2F1b8a4cb0-c3b6-4091-b315-15963488ee79.2Ejpeg/750x562/quality/80/crop-from/center/cr/wqkgUkVDRVRURSA6IFJlbsOpIFNPVVJERUlYL1BSSVNNQVBJWFBIT1RPIDogQnJ1bm8gTUFSSUVMTEUvVmFuZXNzYSBHQVVMVC9QUklTTUFQSVggLyBDdWlzaW5lIEFjdHVlbGxl/pizza-au-saumon-fume.jpeg"));
        Map <String, List<String>> tomates = new HashMap<>();
        tomates.put("Savoyarde", List.of("18€", "data:image/jpeg;base64,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"));
        tomates.put("Tartiflette", List.of("17€", "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRERh_nGSirc_hEYf_u9cM_cc1MmgmUsOIPjA&usqp=CAU"));
        WebhookResponse webHoRes = new WebhookResponse();
        Integer option = 0;
        var base = (String)data.getQueryResult().getParameters().get("Base");
        if (data.getQueryResult().getAction().equals("pizzaSLAction")){
            for (int i=0; i<data.getQueryResult().getOutputContexts().size(); i++){
                if (data.getQueryResult().getOutputContexts().get(i).getName().endsWith("actions_intent_option"))
                    option = (Integer)data.getQueryResult().getOutputContexts().get(i).getParameters().get("OPTION");
                    log.info("{}", option);
            }
            webHoRes.setFulfillmentMessages(List.of(
                    new WebhookResponse.FulfillmentMessage()
                            .setPlatform("ACTIONS_ON_GOOGLE")
                            .setBasicCard(new WebhookResponse.FulfillmentMessage.BasicCard()
                                    .setImageURI("https://pizz-italia.fr/wp-content/uploads/2019/09/pizz-italia-260-1080x675.jpg")
                            ),
                    new WebhookResponse.FulfillmentMessage()
                            .setPlatform("ACTIONS_ON_GOOGLE")
                            .setSimpleResponses(new WebhookResponse.FulfillmentMessage.SimpleResponses().setSimpleResponses(List.of(
                                    new WebhookResponse.FulfillmentMessage.SimpleResponse().setTextToSpeech("Voici ce que vous avez choisi. Voulez-vous un dessert ?")
                            )))
            ));
        }
        else if (data.getQueryResult().getAction().equals("Conseil.Conseil-fallback")) {
            webHoRes.setFullfilmentText("Je n'ai pas bien compris, quelle base ?");
            webHoRes.setFulfillmentMessages(List.of(
                            new WebhookResponse.FulfillmentMessage()
                                    .setPlatform("ACTIONS_ON_GOOGLE")
                                    .setSuggestions(new WebhookResponse.FulfillmentMessage.Suggestions()
                                            .setSuggestions(List.of(
                                                    new WebhookResponse.FulfillmentMessage.Suggestion().setTitle("Crème"),
                                                    new WebhookResponse.FulfillmentMessage.Suggestion().setTitle("Tomate")
                                            ))
                                    ),
                            new WebhookResponse.FulfillmentMessage()
                                    .setPlatform("ACTIONS_ON_GOOGLE")
                                    .setSimpleResponses(new WebhookResponse.FulfillmentMessage.SimpleResponses().setSimpleResponses(List.of(
                                            new WebhookResponse.FulfillmentMessage.SimpleResponse().setTextToSpeech("Une pizza avec quelle base ?")
                                    )))
                    )
            );
        }
        else if (base == null || base.isEmpty()){
            webHoRes.setFullfilmentText("Une pizza avec quelle base ?");
            webHoRes.setFulfillmentMessages(List.of(
                            new WebhookResponse.FulfillmentMessage()
                                    .setPlatform("ACTIONS_ON_GOOGLE")
                                    .setSuggestions(new WebhookResponse.FulfillmentMessage.Suggestions()
                                            .setSuggestions(List.of(
                                                    new WebhookResponse.FulfillmentMessage.Suggestion().setTitle("Crème"),
                                                    new WebhookResponse.FulfillmentMessage.Suggestion().setTitle("Tomate")
                                            ))
                                    ),
                            new WebhookResponse.FulfillmentMessage()
                                    .setPlatform("ACTIONS_ON_GOOGLE")
                                    .setSimpleResponses(new WebhookResponse.FulfillmentMessage.SimpleResponses().setSimpleResponses(List.of(
                                            new WebhookResponse.FulfillmentMessage.SimpleResponse().setTextToSpeech("Une pizza avec quelle base ?")
                                    )))
                    )
            );
        }
        else {
            List<WebhookResponse.FulfillmentMessage.Item> items = new ArrayList<>();
            Integer i = 0;
            for(String pizza:pizzas.get(base)){
                if (base.toLowerCase().equals("creme")){
                    WebhookResponse.FulfillmentMessage.Item item = new WebhookResponse.FulfillmentMessage.Item()
                            .setTitle(pizza)
                            .setDescription(cremes.get(pizza).get(i))
                            .setImage(new WebhookResponse.FulfillmentMessage.Image().setImageUri(cremes.get(pizza).get(i+1)))
                            .setInfo(new WebhookResponse.FulfillmentMessage.Info().setKey(i + pizza));
                    items.add(item);
                    i = i+1;
                }
                else {
                    WebhookResponse.FulfillmentMessage.Item item = new WebhookResponse.FulfillmentMessage.Item()
                            .setTitle(pizza)
                            .setDescription(tomates.get(pizza).get(i))
                            .setImage(new WebhookResponse.FulfillmentMessage.Image().setImageUri(tomates.get(pizza).get(i+1)))
                            .setInfo(new WebhookResponse.FulfillmentMessage.Info().setKey(i + pizza));
                    items.add(item);
                    i = i+1;
                }
            }
            webHoRes.setFulfillmentMessages(List.of(
                    new WebhookResponse.FulfillmentMessage()
                            .setPlatform("ACTIONS_ON_GOOGLE")
                            .setSimpleResponses(new WebhookResponse.FulfillmentMessage.SimpleResponses().setSimpleResponses(List.of(
                                    new WebhookResponse.FulfillmentMessage.SimpleResponse().setTextToSpeech("Bien voici ce que je te propose :")
                    ))),
                    new WebhookResponse.FulfillmentMessage()
                            .setPlatform("ACTIONS_ON_GOOGLE")
                            .setCarouselSelect(new WebhookResponse.FulfillmentMessage.CarouselSelect().setItems(items))
            ));
        }
        return webHoRes;
    }
}